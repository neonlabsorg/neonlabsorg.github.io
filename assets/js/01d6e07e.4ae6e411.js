"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[1189],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return d}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),u=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},f=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),f=u(n),d=r,m=f["".concat(s,".").concat(d)]||f[d]||p[d]||a;return n?o.createElement(m,i(i({ref:t},c),{},{components:n})):o.createElement(m,i({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=f;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var u=2;u<a;u++)i[u]=n[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}f.displayName="MDXCreateElement"},2061:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return c},default:function(){return f}});var o=n(7462),r=n(3366),a=(n(7294),n(3905)),i=["components"],l={},s="Debugging Contracts via Truffle",u={unversionedId:"devportal/using_truffle",id:"devportal/using_truffle",isDocsHomePage:!1,title:"Debugging Contracts via Truffle",description:"This page outlines a methodology for deploying and testing contracts in Neon EVM using the Truffle tool. This technique can be useful for personnel involved in the development and maintenance of Neon EVM.",source:"@site/docs/devportal/using_truffle.md",sourceDirName:"devportal",slug:"/devportal/using_truffle",permalink:"/docs/devportal/using_truffle",tags:[],version:"current",frontMatter:{}},c=[{value:"The Goal",id:"the-goal",children:[]},{value:"Installation",id:"installation",children:[{value:"Requirements for your device",id:"requirements-for-your-device",children:[]},{value:"Installation of Truffle",id:"installation-of-truffle",children:[]},{value:"Installation of the HDWalletProvider library",id:"installation-of-the-hdwalletprovider-library",children:[]}]},{value:"Connecting Truffle to a Proxy",id:"connecting-truffle-to-a-proxy",children:[]},{value:"Configuration",id:"configuration",children:[]},{value:"Compiling Contracts",id:"compiling-contracts",children:[]},{value:"Running Migrations",id:"running-migrations",children:[]},{value:"Testing Contracts",id:"testing-contracts",children:[]},{value:"Example of configuration file settings",id:"example-of-configuration-file-settings",children:[]}],p={toc:c};function f(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"debugging-contracts-via-truffle"},"Debugging Contracts via Truffle"),(0,a.kt)("p",null,(0,a.kt)("em",{parentName:"p"},"This page outlines a methodology for deploying and testing contracts in Neon EVM using the Truffle tool. This technique can be useful for personnel involved in the development and maintenance of Neon EVM.")),(0,a.kt)("p",null,"It should be noted that Ethereum contracts can also be successfully deployed in Neon EVM using Remix in manual mode. Since Remix has not so many capabilities, it turned out to be not very convenient in software development, and therefore we provide developers a more advanced methodology using Truffle."),(0,a.kt)("h2",{id:"the-goal"},"The Goal"),(0,a.kt)("p",null,"Our main goal with Truffle is to make it easier for developers to deploy and debug contacts in Neon EVM."),(0,a.kt)("p",null,"With Truffle, you get:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Simple setting of configuration parameters."),(0,a.kt)("li",{parentName:"ul"},"An easy process of deploying and debugging contacts in the network."),(0,a.kt)("li",{parentName:"ul"},"Automated deploying and running tests.")),(0,a.kt)("h2",{id:"installation"},"Installation"),(0,a.kt)("h3",{id:"requirements-for-your-device"},"Requirements for your device"),(0,a.kt)("p",null,"The following softwares must be installed on your device:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"NodeJS v8.9.4 or later"),(0,a.kt)("li",{parentName:"ul"},"Web3 v1.2.0 or later")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Note:")," Although this tutorial uses the Ubuntu platform, the instructions provided can be applied to other Linux platforms.")),(0,a.kt)("h3",{id:"installation-of-truffle"},"Installation of Truffle"),(0,a.kt)("p",null,"If Truffle is already installed on your device, you can skip this section and move on to the next one. For those just getting started, you need to go through this section."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Note:")," This page is just a quickstart. To go into much detail here, you can see the ",(0,a.kt)("em",{parentName:"p"},(0,a.kt)("a",{parentName:"em",href:"https://www.trufflesuite.com/docs/truffle/getting-started/installation"},"Truffle documentation")),".")),(0,a.kt)("p",null,"Create a new directory for your Truffle project:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ mkdir <project name>\n$ cd <project name>\n")),(0,a.kt)("p",null,"Install Truffle:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ npm install -g truffle\n")),(0,a.kt)("p",null,"To install the default set of contracts and tests, run the following command within the project directory:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ truffle init\n")),(0,a.kt)("p",null,"Once this operation is completed, you will have a project structure with the following items:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"contracts/")," \u2014 Directory for Solidity contracts."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"migrations/")," \u2014 Directory for scriptable deployment files."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"test/")," \u2014 Directory for test files for testing your contracts."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"truffle-config.js")," \u2014 Truffle configuration file.")),(0,a.kt)("p",null,"You can also upload any of your other contracts to the ",(0,a.kt)("inlineCode",{parentName:"p"},"contracts/")," directory for debugging. To do this, you can use the following command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ truffle unbox <your contract>\n")),(0,a.kt)("p",null,"Now you can run ",(0,a.kt)("inlineCode",{parentName:"p"},"truffle compile"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"truffle migrate")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"truffle test")," to compile your contracts, deploy them to the network, and run their associated unit tests."),(0,a.kt)("h3",{id:"installation-of-the-hdwalletprovider-library"},"Installation of the HDWalletProvider library"),(0,a.kt)("p",null,"HD Wallet-enabled Web3 provider (HDWalletProvider) is a standalone library. One of its functions is signing transactions with private keys. Since the Neon EVM proxy does not store private keys, it cannot sign transactions. Therefore, during debugging contracts, the HDWalletProvider library is used to sign transactions for addresses derived from a ",(0,a.kt)("em",{parentName:"p"},"12")," or ",(0,a.kt)("em",{parentName:"p"},"24")," word mnemonic."),(0,a.kt)("p",null,"By default, the Truffle installation does not provide the HDWalletProvider library. If during the installation of Truffle none of the applications also required the HDWalletProvider library to be installed, you need to install it separately."),(0,a.kt)("p",null,"Install the HDWalletProvider library:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ npm install @truffle/hdwallet-provider\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Note:")," To go into much detail here, you can see the ",(0,a.kt)("em",{parentName:"p"},(0,a.kt)("a",{parentName:"em",href:"https://www.npmjs.com/package/@truffle/hdwallet-provider"},"official documentation")),".")),(0,a.kt)("h2",{id:"connecting-truffle-to-a-proxy"},"Connecting Truffle to a Proxy"),(0,a.kt)("p",null,"To connect Truffle to a proxy on node.js, the ",(0,a.kt)("inlineCode",{parentName:"p"},"eth_accounts")," method from the ",(0,a.kt)("a",{parentName:"p",href:"https://eth.wiki/json-rpc/API"},"Ethereum JSON RPC API")," set is required. This method allows serving a list of ",(0,a.kt)("em",{parentName:"p"},"20")," Bytes-addresses owned by a client. Since the Neon EVM proxy does not support the eth_accounts method required to connect Truffle , the HDWalletProvider library is used to function as this method. The connection is configured in ",(0,a.kt)("inlineCode",{parentName:"p"},"truffle-config.js"),"."),(0,a.kt)("p",null,"The configuration file is publicly available and therefore, ",(0,a.kt)("inlineCode",{parentName:"p"},"word mnemonic")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"private key")," contained in the file are also publicly available. This makes it possible to use this data by the library. HDWalletProvider obtains ",(0,a.kt)("inlineCode",{parentName:"p"},"word mnemonic")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"private key")," from the configuration file and uses this data to sign transactions before sending them to the proxy."),(0,a.kt)("p",null,'This method of configuration is convenient for debug mode, but not suitable for work in real conditions. Since the development process uses "test" wallets, this data is not of any value.'),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Note:")," We strongly recommend to use Truffle in Neon EVM only for developing or testing contracts.")),(0,a.kt)("h2",{id:"configuration"},"Configuration"),(0,a.kt)("p",null,"Your configuration file is called ",(0,a.kt)("inlineCode",{parentName:"p"},"truffle-config-neon.js")," and is located at the root of your project directory. This file is a JavaScript file and can execute any code necessary to create your configuration."),(0,a.kt)("h2",{id:"compiling-contracts"},"Compiling Contracts"),(0,a.kt)("p",null,"All of your contracts are located in your project's ",(0,a.kt)("inlineCode",{parentName:"p"},"contracts/")," directory. To compile a Truffle project, change to the root of the directory where the project is located and run the following command:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ truffle compile\n")),(0,a.kt)("p",null,"Upon first run, all contracts will be compiled. Upon subsequent runs, only those contracts will be compiled that have changed since the last compilation."),(0,a.kt)("p",null,"If you want to re-compile all contracts, run the above command with the ",(0,a.kt)("inlineCode",{parentName:"p"},"--all")," option:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ truffle compile --all\n")),(0,a.kt)("h2",{id:"running-migrations"},"Running Migrations"),(0,a.kt)("p",null,"Migration is used to deploy your contracts to the network. This operation is performed using JavaScript files contained in the ",(0,a.kt)("inlineCode",{parentName:"p"},"migration /")," directory. Migrations are simply a set of managed deployment scripts."),(0,a.kt)("p",null,"Run migrations to deploy contracts:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ truffle migrate\n")),(0,a.kt)("p",null,"This will run all migrations located within the ",(0,a.kt)("inlineCode",{parentName:"p"},"migrations/")," directory. If your migrations were previously run successfully, truffle migrate will start execution from the last migration that was run, running only newly created migrations. If no new migrations exist, truffle migrate won't perform any action."),(0,a.kt)("p",null,"If you need to run all migrations from the beginning, instead of running from the last completed migration, you can use the ",(0,a.kt)("inlineCode",{parentName:"p"},"--reset")," option:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ truffle migrate --reset\n")),(0,a.kt)("p",null,"The full set of options that you can use during running migrations are listed in the page with ",(0,a.kt)("a",{parentName:"p",href:"https://www.trufflesuite.com/docs/truffle/reference/truffle-commands#migrate"},"truffle migrate")," command."),(0,a.kt)("h2",{id:"testing-contracts"},"Testing Contracts"),(0,a.kt)("p",null,"All test files should be located in the ",(0,a.kt)("inlineCode",{parentName:"p"},"test/")," directory."),(0,a.kt)("p",null,"To run all tests by default, simply run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ truffle test \n")),(0,a.kt)("p",null,"If you want to run a specific file which does not exist in the ",(0,a.kt)("inlineCode",{parentName:"p"},"test/")," directory, you need to specify a path to that file:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-sh"},"$ truffle test <test_file>\n")),(0,a.kt)("p",null,"The full set of options that you can use during testing are listed in the page with ",(0,a.kt)("a",{parentName:"p",href:"https://www.trufflesuite.com/docs/truffle/reference/truffle-commands#test"},"truffle test")," command."),(0,a.kt)("h2",{id:"example-of-configuration-file-settings"},"Example of configuration file settings"),(0,a.kt)("p",null,"The example of the configuration file for connecting Truffle to a proxy using the one-way library on Node.js:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},'const Web3 = require("web3");\nconst HDWalletProvider = require("@truffle/hdwallet-provider");\n\nconst provider = new Web3.providers.HttpProvider("http://localhost:9090/solana");\n\nconst privateKey = "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"; // Specify your private key here\n\nmodule.exports = {\n  networks: {\n    solana: {\n      provider: () => {\n        return new HDWalletProvider(\n          privateKey,\n          provider,\n        );\n      },\n      from: "0x1beb0aEb41AcA04467BF4FA9913a41188FF9C082",\n      network_id: "*",\n      gas: 3000000,\n      gasPrice: 1000000000,\n    }\n  }\n};\n')),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Note:")," If both mnemonic and private keys are provided, the mnemonic is used.")),(0,a.kt)("p",null,"As contracts of Ethereum are written in Solidity and have a file extension of .sol, associated Solidity libraries will also have a .sol extension."))}f.isMDXComponent=!0}}]);