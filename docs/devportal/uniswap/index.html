<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Neon EVM Docs Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Neon EVM Docs Blog Atom Feed"><title data-react-helmet="true">Porting the uniswap service to Neon EVM | Neon EVM Docs</title><meta data-react-helmet="true" property="og:url" content="https://doc.neonlabs.org/docs/devportal/uniswap"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Porting the uniswap service to Neon EVM | Neon EVM Docs"><meta data-react-helmet="true" name="description" content="The purpose of this document is to share the experience with Ethereum users how easily their applications can be ported to Neon EVM."><meta data-react-helmet="true" property="og:description" content="The purpose of this document is to share the experience with Ethereum users how easily their applications can be ported to Neon EVM."><link data-react-helmet="true" rel="shortcut icon" href="/img/neon_logo_colors.png"><link data-react-helmet="true" rel="canonical" href="https://doc.neonlabs.org/docs/devportal/uniswap"><link data-react-helmet="true" rel="alternate" href="https://doc.neonlabs.org/docs/devportal/uniswap" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://doc.neonlabs.org/docs/devportal/uniswap" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d9bfc96a.css">
<link rel="preload" href="/assets/js/runtime~main.e4fa49ff.js" as="script">
<link rel="preload" href="/assets/js/main.c7f5b5b3.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/neon-logo.png" alt="Neon EVM" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/neon-logo.png" alt="Neon EVM" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Neon Docs</b></a><a class="navbar__item navbar__link" href="/docs/devportal/eth_sol_solution">Develop</a><a class="navbar__item navbar__link" href="/docs/software_manuals/foundational_topics/web3">Manuals</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/neonlabsorg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">About</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Devportal</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devportal/eth_sol_solution">Ethereum and Solana capabilities in a single solution</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devportal/neon_evm_arch">Overview of Neon EVM Architecture</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devportal/value_token">Transaction Value token as an analogue of ETH for Neon EVM Solutions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/devportal/metamask_setup">Installing and setting up MetaMask</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/devportal/uniswap">Porting the uniswap service to Neon EVM</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Testnet</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Software manuals</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Porting the uniswap service to Neon EVM</h1></header><p><em>The purpose of this document is to share the experience with Ethereum users how easily their applications can be ported to Neon EVM.</em></p><blockquote><p>Uniswap is an open-source dApp used on Ethereum. In Ethereum, exchanging some tokens for others requires deploying contracts. We want to demonstrate that our Neon EVM product allows you to port the Uniswap service from Ethereum to Solana. To do this, we deploy the complete Uniswap infrastructure, including contracts in our Neon EVM, as well as the uniswap-interface on a separate server. Using the uniswap service deployed on Neon EVM, users can make transactions in their usual form and make sure that Neon EVM is functioning successfully.  </p></blockquote><p>Any dApp using the Uniswap service consists of 2 parts: contracts and software serving these contracts. Contracts are loaded into a chain, and the software is deployed on a separate server for providing users interaction with these contracts.</p><p>Porting applications from Ethereum to Solana is done in 3 stages:<br>
<strong>Stage 1.</strong> Deploying contracts in a Neon EVM environment.<br>
<strong>Stage 2.</strong> Checking the functioning of deployed contracts.<br>
<strong>Stage 3.</strong> Deploying Uniswap-interface.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="stage-1-deploying-contracts-in-a-neon-evm-environment"></a>Stage 1. Deploying contracts in a Neon EVM environment<a class="hash-link" href="#stage-1-deploying-contracts-in-a-neon-evm-environment" title="Direct link to heading">#</a></h2><p>No changes to the Uniswap product are required to port applications using the Uniswap service. The product version used is Uniswap-v2. Changes are made only to those components that are necessary for its operation on Neon EVM.  </p><p>The contracts are built by a typical Solidity compiler used in Ethereum. After compilation, all the necessary contracts are deployed on Neon EVM using a Web 3 proxy. This proxy provides a standard interface that Ethereum utilities and tools can use.  </p><p>Here is a list of contracts to be deployed:</p><ul><li>Governance.</li><li>Uniswap-v2-periphery.</li><li>Multicall.</li></ul><p><strong>Changes for deploying contracts</strong><br>
The following changes were made for deploying contracts in Neon EVM:</p><ul><li>The timeout value was increased.</li><li>The number of repeated requests for transaction recipes was increased:  </li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// The call  </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    wait factoryV1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createExchange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">WETHPartner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> overrides</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// was replaced with  </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> factoryV1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">createExchange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">WETHPartner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> overrides</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> receipt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">waitForTransaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">id</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hash</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>Added the <code>deploy contracts()</code> method.</li></ul><p>As a result, we get the addresses of the following uploaded contracts:</p><ul><li>UNI_ADDRESS</li><li>TIMELOCK_ADDRESS</li><li>GOVERNANCE_ADDRESS</li><li>MULTICALL_ADDRESS</li><li>MIGRATOR_ADDRESS</li><li>FACTORY_ADDRESS</li><li>ROUTER1_ADDRESS</li><li>ROUTER_ADDRESS</li><li>V1_FACTORY_ADDRESS</li><li>WETH_ADDRESS</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="stage-2-checking-the-functioning-of-deployed-contracts"></a>Stage 2. Checking the functioning of deployed contracts<a class="hash-link" href="#stage-2-checking-the-functioning-of-deployed-contracts" title="Direct link to heading">#</a></h2><p>Contracts health checking is performed in a real chain, not in a test environment, which is fully managed.  </p><p>Unlike the test environment, in a really working chain, the range of test operations cannot be performed in full (for example, operations such as generating a block with a specified number of transactions, etc., are excluded). In a chain, all operations rely on real-time and a user checking the contracts cannot influence the block generation.  </p><p>To test Uniswap, we use the entire set of tests available in Ethereum. The method of running these tests has been changed. Before running the tests, it is indicated that the deployment of contracts, calls to their methods, as well as testing takes place not in the test framework, but in the real blockchain.  </p><blockquote><p>For testing, we use an unmanaged environment. However, in uniswap tests (in contracts), there are sections of program code that contain environment management. In these pieces, we were able to successfully replace the environment management to expectation for a reaction from a chain. That is, where the block is to be generated, a delay is set. Then an action is performed and the reaction of the contract is evaluated, namely, whether it meets the expectation or not. At the same time, we believe that the number of blocks produced may be different.  </p></blockquote><p>The need to adapt tests is due to the fact that tests must issue correct results regardless of the run conditions.  </p><p><strong>Changes for running the uniswap-v2-core test suite</strong><br>
The following changes were made to run the uniswap-v2-core test suite in Neon EVM:</p><ul><li>Increased timeouts when expanding contracts.</li><li>Changed ChainId.</li><li>Replaced the rcp-request libraries, including the following: <code>Web3Provider</code> and <code>MockProvider</code> replaced with <code>JsonRpcProvider</code>.</li><li>Changed the test using the <code>mineBlock()</code> method.</li><li>Increased the number of re-requests in the <code>ethereum-waffle</code> library for receiving transaction receipts, including the following:</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly js"><pre tabindex="0" class="prism-code language-js codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// In the file  </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">uniswap</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">v2</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">core</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">node_modules</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">@ethereum</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">waffle</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">chai</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dist</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cjs</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">matchers</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">emit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">js</span><span class="token plain">  </span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// the line  </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> derivedPromise </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getTransactionReceipt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hash</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">receipt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">  </span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// was replaced with  </span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> derivedPromise </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> promise</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">tx</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> contract</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">provider</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">waitForTransaction</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hash</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">then</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">receipt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">  </span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ul><li>Increased the value of <code>gasLimit</code> in the <code>ethereum-waffle</code> library.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="stage-3-deploying-uniswap-interface"></a>Stage 3. Deploying Uniswap-interface<a class="hash-link" href="#stage-3-deploying-uniswap-interface" title="Direct link to heading">#</a></h2><p>After we have managed to get the addresses of the contracts loaded into the Neon EVM, we can start deploying the uniswap-interface. It is necessary to specify that we use a real blockchain and our contracts are located in this blockchain.  </p><p><strong>Changes for the uniswap-interface</strong><br>
For the uniswap-interface to function successfully in Neon EVM, we were made the following changes:</p><ul><li>Added a new testnet to the adapted uniswap-interface code. The name of the new network with the new chain-ID is registered in all places where it was used, including:<ul><li>Added <code>ChainId LOCAL</code> to dependent libraries and sources.</li><li>ChainID, url was specified in the .env file.</li></ul></li><li>For the new network, a set of the loaded contracts was registered. In the directory <code>node_modules</code>, the addresses of contracts in the sources and dependent libraries were replaced.</li></ul><hr><blockquote><p>The next section contains an example of step-by-step actions for deploying and exchanging a pair of tokens via Neon EVM using Uniswap.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="example-exchanging-tokens-using-uniswap"></a>Example. Exchanging tokens using Uniswap<a class="hash-link" href="#example-exchanging-tokens-using-uniswap" title="Direct link to heading">#</a></h2><p><strong>Initial data</strong><br>
We have 2 types of tokens <em>T_A1</em> and <em>T_B1</em>. There are 10,000 tokens on the balance of each of them. The current rate of <em>T_A1</em> and <em>T_B1</em> tokens is 1:2, respectively.  </p><p><strong>Goal</strong><br>
We need to exchange 1000 <em>T_A1</em> for <em>T_B1</em> tokens.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-1"></a>Step 1<a class="hash-link" href="#step-1" title="Direct link to heading">#</a></h4><p>Connect Metamask to your proxy server (the proxy server should already be deployed in Neon EVM by this time).
To do this, open Metamask and in the settings for <code>Networks</code> in the <code>Neon RPC URL</code> field, write the domain address <a href="https://uniswap-interface.neonlabs.org:9090/solana" target="_blank" rel="noopener noreferrer">https://uniswap-interface.neonlabs.org:9090/solana</a>. This address is required to connect to the proxy server.</p><p align="center"></p><p><img src="/assets/images/uniswap-1-34abe0055c20e1e3638c4ce93bda10a3.png">  </p><p></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-2"></a>Step 2<a class="hash-link" href="#step-2" title="Direct link to heading">#</a></h4><p>Create and deploy an ER20 standard contract containing the <em>T_A1</em> token.
To do this, open the Remix web application and load the ERC20 contract into it. Write the data of the <em>T_A1</em> token to this contract.</p><p align="center"></p><p><img src="/assets/images/uniswap-2-659ee92e29d6512c3b7e4481b93369fe.png">  </p><p></p><p>After editing the text, compile the contract.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-3"></a>Step 3<a class="hash-link" href="#step-3" title="Direct link to heading">#</a></h4><p>Ð¡lick <code>Deploy</code> in the Remix web application.<br>
Metamask will activate to determine the required signature and add it to the transaction. The transaction will be sent to the proxy server and then to Solana. After the transaction is successfully completed, the contract containing the <em>T_A1</em> token will be deployed.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-4"></a>Step 4<a class="hash-link" href="#step-4" title="Direct link to heading">#</a></h4><p>Repeat actions of 2 and 3 steps to create and deploy a contract for the <em>T_B1</em> token.<br>
If the operations for deploying contracts for <em>T_A1</em> and <em>T_B1</em> tokens are completed successfully, 2 addresses of these contracts will appear in the lower-left corner of the Metamask window. To the right of the address is an icon for copying this address.</p><p align="center"></p><p><img src="/assets/images/uniswap-3-548c9157c76300e5de0bd759259a8624.png">  </p><p></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-5"></a>Step 5<a class="hash-link" href="#step-5" title="Direct link to heading">#</a></h4><p><em>For an exchange operation, it is necessary to create a liquidity pool for a pair of tokens that will be exchanged. Certain amounts should be debited from the balances of these tokens. The exchange operation must be carried out within these amounts.</em>  </p><p>Open the main page of the <a href="https://swap-interface.neondemo.org" target="_blank" rel="noopener noreferrer">Uniswap interface</a> (registration is required to enter this page). The address of Metamask is indicated in the upper right corner. There are 2 operations in the upper left menu:</p><ul><li><code>Swap</code> - token exchange operation.</li><li><code>Pool</code> - creates a pair of tokens between which an exchange operation will be performed.</li></ul><p>In the menu, click <code>Pool</code> and In the pop-up window, click <code>Create a pair</code>.</p><p align="center"></p><p><img src="/assets/images/uniswap-4-901e5f99b269ca848c2a98de3e8e4265.png">  </p><p></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-6"></a>Step 6<a class="hash-link" href="#step-6" title="Direct link to heading">#</a></h4><p>In the Remix window, you need to copy the <em>T_A1</em> token address. Then open the Uniswap window and write this address into the <code>Select a token</code> field. Click <code>Import</code>.</p><p align="center"></p><p><img src="/assets/images/uniswap-5-d1c95ed2db0c006d073d5483a1a4a6d3.png">  </p><p></p><p>Repeat this step to copy the <em>T_B1</em> token address.  </p><blockquote><p>When creating a liquidity pair, a warning about the risk of selling a token back may appear.</p></blockquote><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-7"></a>Step 7<a class="hash-link" href="#step-7" title="Direct link to heading">#</a></h4><p>After setting a pair of tokens, a pop-up window should appear with the balances of these tokens.<br>
Specify the amount for which the liquidity pool is created. For example, let&#x27;s assume that there are 10,000 tokens on the balances of both tokens. Also, let&#x27;s create a pair of tokens with values 1000 and 2000 for <em>T_A1</em> and <em>T_B1</em> respectively. This means the exchange operation can be performed for amounts not exceeding 1000 and 2000 tokens for <em>T_A1</em> and <em>T_B1</em>, respectively. These amounts will be reserved for exchange. The exchange rate is 1:2.</p><p align="center"></p><p><img src="/assets/images/uniswap-6-1aa752403aa8851bd5164cefad1414c0.png">  </p><p></p><p>Creating a liquidity pair requires an approval operation for both tokens. The need for the operation is due to the ERC20 contract requirement.  </p><p>Click <code>Approve_TA1</code> and then confirm the operation in the Metamask pop-up window. Repeat this operation for another token.  </p><p>After receiving a notification about the successful completion of both transactions, click <code>Supply</code>.  </p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-8"></a>Step 8<a class="hash-link" href="#step-8" title="Direct link to heading">#</a></h4><p>In the window that appears, click <code>Create Pool &amp; Supply</code>. Confirm this operation in the Metamask window.</p><p align="center"></p><p><img src="/assets/images/uniswap-7-8e64b53c466d7d17972ce49bccdd5083.png">  </p><p></p><p>After receiving a notification about the successful completion of the transaction, click <code>Close</code></p><p align="center"></p><p><img src="/assets/images/uniswap-8-297cccd8affe7bee55f8869e5bb07f2e.png">  </p><p></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-9"></a>Step 9<a class="hash-link" href="#step-9" title="Direct link to heading">#</a></h4><p>Make sure the balances have been updated. The balances of the <em>T_A1</em> and <em>T_B1</em> tokens should be reduced by 1000 and 2000 tokens, respectively. Now the token exchange operation can be performed.  </p><p>In the upper left corner of the Uniswap window, select the <code>Swap</code> operation.</p><p align="center"></p><p><img src="/assets/images/uniswap-9-5f0f7418fea85353d0fc0573c6956223.png">  </p><p></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-10"></a>Step 10<a class="hash-link" href="#step-10" title="Direct link to heading">#</a></h4><p>In the appearing Swap window, select the <em>T_A1</em> and <em>T_B1</em> tokens using <code>Select a token</code>. Specify the exchange amount in <code>From</code>. The amount for <em>T_B1</em> will automatically appear in <code>To</code>. This amount is calculated taking into account the exchange rate and fee. The exchange rate is calculated based on the amounts of tokens specified in the pair.  </p><p>For example, let&#x27;s specify the exchange amount of 1 token.</p><p align="center"></p><p><img src="/assets/images/uniswap-10-23abb8bff506f322adef0d468c13c7a0.png">  </p><p></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="step-11"></a>Step 11<a class="hash-link" href="#step-11" title="Direct link to heading">#</a></h4><p>Click <code>Swap</code> and then <code>Confirm swap</code>.<br>
After the transaction is completed successfully, click <code>Close</code> to end the session. The final Swap window should appear with updated token balances. The <em>T_A1</em> balance will decrease by 1 token, and the <em>T_B1</em> balance will increase by almost 2 tokens.</p><p align="center"></p><p><img src="/assets/images/uniswap-11-6a2ca662b4812bc843c88f58b5a11333.png">  </p><p></p><hr><blockquote><p><strong>More details</strong><br>
All changes we made for Porting the uniswap service to Neon EVM can be found in the <a href="https://github.com/neonlabsorg/uniswap-v2-core" target="_blank" rel="noopener noreferrer">uniswap-v2-core repository</a>.</p></blockquote></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/neonlabsorg/neon-evm.docs/docs/devportal/uniswap.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/devportal/metamask_setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Installing and setting up MetaMask</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/devportal/testnet/connect_to_solana_via_proxy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Connecting to the Solana cluster via proxy server Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#stage-1-deploying-contracts-in-a-neon-evm-environment" class="table-of-contents__link">Stage 1. Deploying contracts in a Neon EVM environment</a></li><li><a href="#stage-2-checking-the-functioning-of-deployed-contracts" class="table-of-contents__link">Stage 2. Checking the functioning of deployed contracts</a></li><li><a href="#stage-3-deploying-uniswap-interface" class="table-of-contents__link">Stage 3. Deploying Uniswap-interface</a></li><li><a href="#example-exchanging-tokens-using-uniswap" class="table-of-contents__link">Example. Exchanging tokens using Uniswap</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Introduction</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.com/invite/d9BhxNWTsj" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/neonlabsorg" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://neonlabs.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">NeonLabs.org</a></li><li class="footer__item"><a href="https://github.com/neonlabsorg" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Solana Foundation</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e4fa49ff.js"></script>
<script src="/assets/js/main.c7f5b5b3.js"></script>
</body>
</html>